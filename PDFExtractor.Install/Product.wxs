<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  
  <!-- Fixed upgrade code-->
  <?define UpgradeCode = {78C882A4-9A3D-4E83-A0B8-D839E7C4031C}?>
    
	<!-- Product information -->
  <Product Id="*"
           Name="!(loc.ProductName)"
           Language="1033"
           Codepage="1257"
           Version="$(var.BuildVersion)"
           Manufacturer="!(loc.MakerName)"
           UpgradeCode="$(var.UpgradeCode)">

    <!-- Package information -->
    <Package InstallerVersion="200"
             Compressed="yes"
             InstallScope="perUser"
             InstallPrivileges="limited"
             Manufacturer="!(loc.MakerName)"
             Description="!(loc.Description)"
             Keywords="!(loc.Keywords)"
             />

    <!-- Downgrade error message-->
    <MajorUpgrade DowngradeErrorMessage="!(loc.DowngradeMessage)" />

    <!-- Embed archive file-->
    <MediaTemplate EmbedCab="yes"/>

    <!-- Application icon-->
    <Icon Id="appicon" SourceFile="$(var.PDFExtractor.ProjectDir)\appIcon.ico"/>
    <!-- Use application icon for installer -->
    <Property Id="ARPPRODUCTICON">appicon</Property>

    <UI Id="WixUI_Minimal">
      <TextStyle Id="WixUI_Font_Normal" FaceName="Tahoma" Size="8" />
      <TextStyle Id="WixUI_Font_Bigger" FaceName="Tahoma" Size="12" />
      <TextStyle Id="WixUI_Font_Title" FaceName="Tahoma" Size="9" Bold="yes" />

      <Property Id="DefaultUIFont" Value="WixUI_Font_Normal" />
      <Property Id="WixUI_Mode" Value="Minimal" />

      <DialogRef Id="ErrorDlg" />
      <DialogRef Id="FatalError" />
      <DialogRef Id="FilesInUse" />
      <DialogRef Id="MsiRMFilesInUse" />
      <DialogRef Id="PrepareDlg" />
      <DialogRef Id="ProgressDlg" />
      <DialogRef Id="ResumeDlg" />
      <DialogRef Id="UserExit" />

      <!-- This is the welcome dialog you specified-->
      <DialogRef Id="WelcomeDlg" />

      <!-- Hook the new welcome dialog to the next one in the stack-->
      <Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="PrepareDlg">1</Publish>

      <Publish Dialog="ExitDialog" Control="Finish" Event="EndDialog" Value="Return" Order="999">1</Publish>

      <Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="MaintenanceTypeDlg">1</Publish>

      <Publish Dialog="MaintenanceWelcomeDlg" Control="Next" Event="NewDialog" Value="MaintenanceTypeDlg">1</Publish>

      <Publish Dialog="MaintenanceTypeDlg" Control="RepairButton" Event="NewDialog" Value="VerifyReadyDlg">1</Publish>
      <Publish Dialog="MaintenanceTypeDlg" Control="RemoveButton" Event="NewDialog" Value="VerifyReadyDlg">1</Publish>
      <Publish Dialog="MaintenanceTypeDlg" Control="Back" Event="NewDialog" Value="MaintenanceWelcomeDlg">1</Publish>

      <Property Id="ARPNOMODIFY" Value="1" />
    </UI>

    <UIRef Id="WixUI_Common" />

    <!-- Define components, shortcuts, files etc... -->
    <Feature Id="ProductFeature" Title="Kirjalliset todisteet" Level="1">
      <ComponentGroupRef Id="PublishedComponents"/>
      <ComponentGroupRef Id="ProductComponents"/>
    </Feature>
  </Product>
</Wix>
